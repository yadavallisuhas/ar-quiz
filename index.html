<!DOCTYPE html>
<html>
<head>
  <title>Pseudo AR Quiz</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script>
  <style>
    body { margin: 0; overflow: hidden; font-family: sans-serif; }
    .instructions {
      position: absolute;
      top: 10px; left: 50%; transform: translateX(-50%);
      background: rgba(0,0,0,0.6); color: #fff; padding: 8px 12px; border-radius: 5px;
      font-size: 14px; text-align: center;
      z-index: 10;
    }
  </style>
</head>
<body>
  <div class="instructions">
    Tap and drag the panel to move it. Select answers to score points!
  </div>

  <a-scene embedded>
    <!-- Transparent "floor" for placement -->
    <a-plane position="0 0 0" rotation="-90 0 0" width="4" height="4" material="color:#ccc; opacity:0.1"></a-plane>

    <!-- Quiz Panel -->
    <a-entity id="quizPanel" position="0 0.5 -1" rotation="0 0 0" draggable>
      <a-plane color="#ffffff" height="1.3" width="2.2" shadow radius="0.05"></a-plane>

      <!-- Question -->
      <a-text id="questionText" value="" color="#000" width="2" align="center" position="0 0.45 0"></a-text>

      <!-- Answer Buttons -->
      <a-box id="optA" position="-0.6 0 0.05" depth="0.05" height="0.2" width="1" color="#4CAF50" class="answer">
        <a-text value="" align="center" position="0 0 0.03" color="#fff" width="2"></a-text>
      </a-box>

      <a-box id="optB" position="0.6 0 0.05" depth="0.05" height="0.2" width="1" color="#2196F3" class="answer">
        <a-text value="" align="center" position="0 0 0.03" color="#fff" width="2"></a-text>
      </a-box>

      <a-box id="optC" position="-0.6 -0.35 0.05" depth="0.05" height="0.2" width="1" color="#FF9800" class="answer">
        <a-text value="" align="center" position="0 0 0.03" color="#fff" width="2"></a-text>
      </a-box>

      <a-box id="optD" position="0.6 -0.35 0.05" depth="0.05" height="0.2" width="1" color="#f44336" class="answer">
        <a-text value="" align="center" position="0 0 0.03" color="#fff" width="2"></a-text>
      </a-box>

      <!-- Score -->
      <a-text id="scoreText" value="Score: 0" color="#000" width="2" align="center" position="0 -0.7 0"></a-text>
    </a-entity>
  </a-scene>

  <script>
    // Simple drag component for the panel
    AFRAME.registerComponent('draggable', {
      init: function () {
        this.isDragging = false;
        this.el.addEventListener('mousedown', () => this.isDragging = true);
        this.el.addEventListener('mouseup', () => this.isDragging = false);
        this.el.addEventListener('mouseleave', () => this.isDragging = false);
        this.el.addEventListener('touchstart', () => this.isDragging = true);
        this.el.addEventListener('touchend', () => this.isDragging = false);
      },
      tick: function () {
        if (!this.isDragging) return;
        let touch = null;
        if (window.event && window.event.touches) touch = window.event.touches[0];
        if (!touch) return;
        const scene = this.el.sceneEl;
        const camera = scene.camera;
        const raycaster = new THREE.Raycaster();
        raycaster.setFromCamera({x: (touch.clientX / window.innerWidth)*2-1, y: -(touch.clientY / window.innerHeight)*2+1}, camera);
        const intersects = raycaster.intersectObjects(scene.object3D.children, true);
        if (intersects.length) {
          this.el.object3D.position.copy(intersects[0].point);
          this.el.object3D.position.y += 0.5;
        }
      }
    });

    // Quiz logic
    const questions = [
      { q: "What is the capital of France?", options: ["Paris","Berlin","Rome","Madrid"], answer:"Paris" },
      { q: "Which planet is known as the Red Planet?", options: ["Venus","Mars","Jupiter","Mercury"], answer:"Mars" },
      { q: "Who wrote 'Romeo and Juliet'?", options: ["Shakespeare","Hemingway","Tolkien","Dickens"], answer:"Shakespeare" }
    ];

    let current = 0;
    let score = 0;

    const questionText = document.getElementById('questionText');
    const scoreText = document.getElementById('scoreText');
    const answers = document.querySelectorAll('.answer');

    function loadQuestion() {
      if (current >= questions.length) {
        questionText.setAttribute('value', `Quiz Over!\nYour Score: ${score}/${questions.length}`);
        answers.forEach(a=>a.setAttribute('visible', false));
        scoreText.setAttribute('value','');
        return;
      }
      const q = questions[current];
      questionText.setAttribute('value', `Q${current+1}: ${q.q}`);
      const ids = ['optA','optB','optC','optD'];
      ids.forEach((id,i)=>{
        const box = document.getElementById(id);
        const text = box.querySelector('a-text');
        text.setAttribute('value', q.options[i]);
        box.setAttribute('data-answer', q.options[i]);
        box.setAttribute('visible', true);
      });
      scoreText.setAttribute('value', `Score: ${score}`);
    }

    answers.forEach(el=>{
      el.addEventListener('click', ()=>{
        const ans = el.getAttribute('data-answer');
        if(ans === questions[current].answer) score++;
        current++;
        loadQuestion();
      });
    });

    loadQuestion();
  </script>
</body>
</html>
